## Урок 9. Линейная регрессия Логистическая регрессия
##### 1) Даны значения величины заработной платы заемщиков банка (zp) и значения их поведенческого кредитного скоринга (ks): zp = [35, 45, 190, 200, 40, 70, 54, 150, 120, 110], ks = [401, 574, 874, 919, 459, 739, 653, 902, 746, 832]. Используя математические операции, посчитать коэффициенты линейной регрессии, приняв за X заработную плату (то есть, zp - признак), а за y - значения скорингового балла (то есть, ks - целевая переменная). Произвести расчет как с использованием intercept, так и без.
#### 2) Посчитать коэффициент линейной регрессии при заработной плате (zp), используя градиентный спуск (без intercept).
#### 3) Произвести вычисления как в пункте 2, но с вычислением intercept. Учесть, что изменение коэффициентов должно производиться на каждом шаге одновременно (то есть изменение одного коэффициента не должно влиять на изменение другого во время одной итерации).

### 1) Расчет коэффициентов линейной регрессии


```python
import numpy as np

zp = np.array([35, 45, 190, 200, 40, 70, 54, 150, 120, 110])
ks = np.array([401, 574, 874, 919, 459, 739, 653, 902, 746, 832])
```


```python
# Расчет с использованием intercept
b1 = (np.mean(zp * ks) - np.mean(zp) * np.mean(ks)) / (np.mean(zp**2) - np.mean(zp)**2)
b0 = np.mean(ks) - b1 * np.mean(zp)

# Расчет без использования intercept
b = np.dot(zp, ks) / np.dot(zp, zp)

print(f"Коэффициент наклона (b1): {b1}")
print(f"Коэффициент пересечения (b0, intercept): {b0}")
print(f"Коэффициент наклона (b) без intercept: {b}")
```

    Коэффициент наклона (b1): 2.620538882402765
    Коэффициент пересечения (b0, intercept): 444.1773573243596
    Коэффициент наклона (b) без intercept: 5.889820420132689
    

### 2) Градиентный спуск без intercept


```python
# Градиентный спуск для определения коэффициента линейной регрессии без intercept

# Инициализация начального значения коэффициента b1 и шага обучения alpha
b1 = 0.1
alpha = 1e-6

for i in range(1000):  # Количество итераций градиентного спуска
    b1 -= alpha * (2/len(zp)) * np.sum((b1 * zp - ks) * zp)
    
print(f"Коэффициент наклона (b1) после градиентного спуска: {b1}")
```

    Коэффициент наклона (b1) после градиентного спуска: 5.889820420128437
    

### 3) Градиентный спуск с intercept


```python
# Градиентный спуск для определения коэффициентов линейной регрессии с intercept

# Инициализация начальных значений коэффициентов b0 и b1 и шага обучения alpha
b0, b1 = 0.1, 0.1
alpha = 1e-5

for i in range(1000):  # Количество итераций градиентного спуска
    y_pred = b0 + b1 * zp
    b0 -= alpha * (2/len(zp)) * np.sum(y_pred - ks)
    b1 -= alpha * (2/len(zp)) * np.sum((y_pred - ks) * zp)
    
print(f"Коэффициент пересечения (b0, intercept) после градиентного спуска: {b0}")
print(f"Коэффициент наклона (b1) после градиентного спуска: {b1}")
```

    Коэффициент пересечения (b0, intercept) после градиентного спуска: 2.3895086054596977
    Коэффициент наклона (b1) после градиентного спуска: 5.872292774601917
    
